;class RegionsChoose{constructor(){this.getRegion(),this.rootId="regions_choose_component",this.rootDropDownId="regions_choose_component_dropdown",this.selectRegionID="regon_choose_select-city__modal",this.selectRegionOverlayID="regon_choose_modal__overlay",this.questionRegionId=null,this.loctionList=null,this.bigCityList=null,this.countryList=null,this.activCountry=null,this.defoultExampleRegion=null,this.root=document.getElementById(this.rootId),this.rootDropDown=document.getElementById(this.rootDropDownId),this.selectRegion=document.getElementById(this.selectRegionID),this.selectRegionOverlay=document.getElementById(this.selectRegionOverlayID),this.setEvents()}getEntity(t,e,i=!1){return t&&e?i?t.querySelectorAll('[data-entity="'+e+'"]'):t.querySelector('[data-entity="'+e+'"]'):null}setEvents(){const t=this.getEntity(this.rootDropDown,"select-city__dropdown__choose__yes"),e=this.getEntity(this.rootDropDown,"select-city__dropdown__choose__no"),i=this.getEntity(this.root,"open_region"),o=this.getEntity(this.selectRegion,"select-city__close"),n=this.getEntity(this.selectRegion,"select-city__modal__submit__input");this.defoultExampleRegion=this.getEntity(this.selectRegion,"select-city__input__example").cloneNode(!0),t.addEventListener("click",()=>this.onSetRegion(this.questionRegionId)),e.addEventListener("click",()=>{this.onShowALLRegions(),this.dropDownShow(!1)}),i.addEventListener("click",()=>this.onShowALLRegions()),o.addEventListener("click",()=>this.onSelectRegionShow(!1)),n.addEventListener("input",t=>this.onInputSearch(t)),window.addEventListener("load",()=>{this.origamiMenuCity=document.getElementById("menu-city"),this.origamiMenuCity&&this.origamiMenuCity.addEventListener("click",t=>{"menu-city"===t.target.id&&this.onShowALLRegions()})})}onSetRegion(t){BX.ajax.runAction("kit:regions.ChooseComponentController.setRegion",{data:{regionId:t}}).then(t=>t.data.actions.forEach(e=>this[e](t.data)),t=>{console.log(t)})}dropDownShow(t){t?this.rootDropDown.setAttribute("style","display: block;"):this.rootDropDown.setAttribute("style","display: none;")}onShowALLRegions(t=Number.MAX_SAFE_INTEGER){BX.ajax.runAction("kit:regions.ChooseComponentController.showLocations",{data:{countryId:t}}).then(t=>t.data.actions.forEach(e=>this[e](t.data)),t=>console.log(t))}getRegion(t=!1){const e=new URLSearchParams(window.location.search),i=t?{deletCookies:1}:{redirectRegionId:e.get("redirectRegionId")};this.removeRegionGetParams(e),BX.ajax.runAction("kit:regions.ChooseComponentController.getRegion",{data:i}).then(t=>t.data.actions.forEach(e=>this[e](t.data)),t=>console.log(t))}onSelectRegionShow(t){const e=document.getElementById("menu-header-three");if(e&&e.classList.contains("show")&&this.origamiMenuCity){let e=null;if(t){if(this.origamiMenuCity.querySelector(`#${this.selectRegionID}`))e=this.origamiMenuCity.querySelector(`#${this.selectRegionID}`);else{(e=this.selectRegion.cloneNode(!0)).classList.forEach(t=>{e.classList.remove(t)}),e.classList.add("select-city__modal_for_menu"),this.getEntity(e,"select-city__modal__submit__input").addEventListener("input",t=>this.onInputSearch(t,e))}e.setAttribute("style","display: block;"),this.getEntity(e,"select-city__close").addEventListener("click",()=>this.onSelectRegionShow(!1)),this.origamiMenuCity.append(e)}else{this.origamiMenuCity.querySelector(`#${this.selectRegionID}`).setAttribute("style","display: none;")}return e}return t?(this.selectRegion.setAttribute("style","display: flex;"),this.selectRegionOverlay.setAttribute("style","display: block;")):(this.selectRegion.setAttribute("style","display: none;"),this.selectRegionOverlay.setAttribute("style","display: none;")),this.selectRegion}SHOW_REGION_NAME({currentRegionName:t}){this.getEntity(this.root,"open_region").innerText=t,this.getEntity(this.selectRegion,"select-city__name").innerText=t}SHOW_QUESTION({currentRegionName:t,currentRegionId:e}){this.questionRegionId=e,this.dropDownShow(!0);const i=this.getEntity(this.rootDropDown,"select-city__dropdown__title");i.innerText=i.textContent.replace("###",t).trim()}CONFIRM_DOMAIN({currentRegionName:t}){this.dropDownShow(!1),this.getEntity(this.root,"open_region").innerText=t,this.getEntity(this.selectRegion,"select-city__name").innerText=t,this.getEntity(this.selectRegion,"select-city__js").innerText=t}SHOW_SELECT_REGIONS({allRegions:t,locationTemplateData:e}){const i=this.onSelectRegionShow(!0);let o=i.querySelector(".scroll-container");new PerfectScrollbar(o,{wheelSpeed:.5,wheelPropagation:!0,minScrollbarLength:20}),null===e&&(e={bigCity:t,country:{},activ:0});const n=this.getEntity(i,"select-city__list_wrapper_cities").childNodes.length;this.activCountry===e.activ&&n>0||(this.loctionList=t,this.countryList=e.country,this.activCountry=e.activ,this.bigCityList=e.bigCity,this.citysRender(i),this.renderCountryTabs(i))}REDIRECT_TO_SUBDOMAIN({currentRegionCode:t,currentRegionId:e}){const i=window.location.hostname,o=window.location.protocol,n=window.location.href.replace(i,t),s=new URL(n,`${o}${t}`);s.searchParams.set("redirectRegionId",e),window.location.href=s.toString()}onInputSearch(t,e){this.searchLine=t.currentTarget.value,this.citysRender(e||this.selectRegion)}citysRender(t){const e=this.getEntity(this.getEntity(t,"select-city__list_wrapper_favorites"),"select-city__list"),i=this.getEntity(t,"select-city__list_wrapper_cities"),o=this.getEntity(t,"select-city__input__example");Array.from(e.childNodes).forEach(t=>t.remove()),Array.from(i.childNodes).forEach(t=>t.remove()),Array.from(o.childNodes).forEach(t=>t.remove()),o.innerHTML=this.defoultExampleRegion.innerHTML,this.bigCityList&&0!==Object.keys(this.bigCityList).length?this.getEntity(t,"select-city__tab_name_content__big_city").setAttribute("style","display: block;"):this.getEntity(t,"select-city__tab_name_content__big_city").setAttribute("style","display: none;"),Object.keys(this.bigCityList).filter(t=>new RegExp(this.searchLine,"i").test(this.bigCityList[t])).forEach(t=>{const i=document.createElement("p");i.setAttribute("class","select-city__list_item"),i.innerText=this.bigCityList[t],i.addEventListener("click",()=>{this.onSetRegion(t)}),e.append(i)});const n=new Set(Object.values(this.loctionList).filter(t=>new RegExp(this.searchLine,"i").test(t)).map(t=>t[0]));Array.from(n).forEach(t=>{const e=document.createElement("div");e.setAttribute("class","select-city__list_letter_wrapper");const o=document.createElement("div");o.setAttribute("class","select-city__list_letter"),o.innerText=t,e.append(o);const n=document.createElement("div");n.setAttribute("class","select-city__list"),Object.keys(this.loctionList).filter(e=>t===this.loctionList[e][0]).filter(t=>new RegExp(this.searchLine,"i").test(this.loctionList[t])).forEach(t=>{const e=document.createElement("p");e.setAttribute("class","select-city__list_item"),e.addEventListener("click",()=>{this.onSetRegion(t)}),e.innerText=this.loctionList[t],n.append(e)}),e.append(n),i.append(e)});const s=Object.keys(this.loctionList);Array.from(o.querySelectorAll("span")).forEach((t,e)=>{t.innerText=this.loctionList[s[e]],t.addEventListener("click",()=>{this.onSetRegion(s[e])})})}renderCountryTabs(t){const e=this.getEntity(t,"kit-regions-tabs");if(Array.from(e.childNodes).filter(t=>t instanceof HTMLLIElement).length>0)return;Object.keys(this.countryList).forEach(i=>{const o=document.createElement("li");this.activCountry===i?o.setAttribute("class","select-city__tab active"):o.setAttribute("class","select-city__tab"),o.innerText=this.countryList[i],o.addEventListener("click",()=>{if(o.classList.contains("active"))return;const e=this.getEntity(t,"kit-regions-tabs");Array.from(e.childNodes).forEach(t=>{t instanceof HTMLLIElement&&t.classList.remove("active")}),o.classList.add("active"),this.onShowALLRegions(i)}),e.append(o)})}removeRegionGetParams(t){if(t.has("redirectRegionId")){const t=new URL(window.location.href,window.location.href);t.searchParams.delete("redirectRegionId"),window.history.replaceState(null,"",t)}}};