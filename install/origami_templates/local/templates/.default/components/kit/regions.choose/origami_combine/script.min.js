;class RegionsChoose{constructor(){this.getRegion(),this.rootId="regions_choose_component",this.rootDropDownId="regions_choose_component_dropdown",this.selectRegionID="regon_choose_select-city__modal",this.selectRegionOverlayID="regon_choose_modal__overlay",this.questionRegionId=null,this.currentRegionId=null,this.loctionList=null,this.root=document.getElementById(this.rootId),this.rootDropDown=document.getElementById(this.rootDropDownId),this.selectRegion=document.getElementById(this.selectRegionID),this.selectRegionOverlay=document.getElementById(this.selectRegionOverlayID),this.setEvents()}getEntity(t,e,i=!1){return t&&e?i?t.querySelectorAll('[data-entity="'+e+'"]'):t.querySelector('[data-entity="'+e+'"]'):null}setEvents(){const t=this.getEntity(this.rootDropDown,"select-city__dropdown__choose__yes"),e=this.getEntity(this.rootDropDown,"select-city__dropdown__choose__no"),i=this.getEntity(this.root,"open_region"),o=this.getEntity(this.selectRegion,"select-city__close"),n=this.getEntity(this.selectRegion,"select-city__modal__submit__input"),s=this.getEntity(this.selectRegion,"select-city__modal__submit__btn"),r=this.getEntity(this.selectRegion,"select-city__automatic");t.addEventListener("click",()=>this.onSetRegion(this.questionRegionId)),e.addEventListener("click",()=>{this.onShowALLRegions(),this.dropDownShow(!1)}),i.addEventListener("click",()=>this.onShowALLRegions()),o.addEventListener("click",()=>this.onSelectRegionShow(!1)),n.addEventListener("input",t=>this.onInputSearch(t)),r.addEventListener("click",()=>this.getRegion(!0)),window.addEventListener("load",()=>{this.origamiMenuCity=document.getElementById("menu-city"),this.origamiMenuCity&&this.origamiMenuCity.addEventListener("click",t=>{"menu-city"===t.target.id&&this.onShowALLRegions()})}),s.addEventListener("click",()=>{const t=Object.keys(this.loctionList).filter(t=>n.value===this.loctionList[t]);0!==t.length&&(this.onSetRegion(t[0]),this.onShowALLRegions(!1))})}onSetRegion(t){BX.ajax.runAction("kit:regions.ChooseComponentController.setRegion",{data:{regionId:t}}).then(t=>t.data.actions.forEach(e=>this[e](t.data)),t=>console.log(t))}dropDownShow(t){t?this.rootDropDown.setAttribute("style","display: block;"):this.rootDropDown.setAttribute("style","display: none;")}onShowALLRegions(){if(null!==this.loctionList)return this.SHOW_SELECT_REGIONS(this.loctionList);BX.ajax.runAction("kit:regions.ChooseComponentController.showLocations",{}).then(t=>t.data.actions.forEach(e=>this[e](t.data)),t=>console.log(t))}getRegion(t=!1){const e=new URLSearchParams(window.location.search),i=t?{deletCookies:1}:{redirectRegionId:e.get("redirectRegionId")};this.removeRegionGetParams(e),BX.ajax.runAction("kit:regions.ChooseComponentController.getRegion",{data:i}).then(e=>{e.data.actions.forEach(t=>this[t](e.data)),t&&(this.dropDownShow(!1),this.onSelectRegionShow(!1),this.onSetRegion(e.data.currentRegionId))},t=>console.log(t))}onSelectRegionShow(t){const e=document.getElementById("menu-header-three");if(e&&e.classList.contains("show")&&this.origamiMenuCity){let e=null;if(t){if(this.origamiMenuCity.parentNode.querySelector(`#${this.selectRegionID}`))e=this.origamiMenuCity.parentNode.querySelector(`#${this.selectRegionID}`);else{(e=this.selectRegion.cloneNode(!0)).classList.forEach(t=>{e.classList.remove(t)}),e.classList.add("select-city__modal_for_menu");const t=this.getEntity(e,"select-city__modal__submit__input"),i=this.getEntity(e,"select-city__close"),o=this.getEntity(e,"select-city__modal__submit__btn"),n=this.getEntity(e,"select-city__automatic");i.addEventListener("click",()=>this.onSelectRegionShow(!1)),t.addEventListener("input",t=>this.onInputSearch(t,e)),n.addEventListener("click",()=>this.getRegion(!0)),o.addEventListener("click",()=>{const e=Object.keys(this.loctionList).filter(e=>t.value===this.loctionList[e]);0!==e.length&&(this.onSetRegion(e[0]),this.onShowALLRegions(!1))})}e.setAttribute("style","display: block;"),this.origamiMenuCity.parentNode.append(e)}else{this.origamiMenuCity.parentNode.querySelector(`#${this.selectRegionID}`).setAttribute("style","display: none;")}return e}return t?(this.selectRegion.setAttribute("style","display: block;"),this.selectRegionOverlay.setAttribute("style","display: block;")):(this.selectRegionOverlay.setAttribute("style","display: none;"),this.selectRegion.setAttribute("style","display: none;")),this.selectRegion}SHOW_REGION_NAME({currentRegionName:t,currentRegionId:e}){this.getEntity(this.root,"open_region").innerText=t,this.currentRegionId=e}SHOW_QUESTION({currentRegionName:t,currentRegionId:e}){this.questionRegionId=e,this.dropDownShow(!0);const i=this.getEntity(this.rootDropDown,"select-city__dropdown__title");i.innerText=i.textContent.replace("###",t).trim()}CONFIRM_DOMAIN({currentRegionName:t}){this.dropDownShow(!1),this.getEntity(this.root,"open_region").innerText=t,this.getEntity(this.selectRegion,"select-city__js").innerText=t}SHOW_SELECT_REGIONS({allRegions:t}){const e=this.onSelectRegionShow(!0);if(null!==this.loctionList)return;this.loctionList=t;const i=this.getEntity(e,"select-city__input__example"),o=Object.keys(this.loctionList);Array.from(i.querySelectorAll("span")).forEach((t,e)=>{t.innerText=this.loctionList[o[e]],t.addEventListener("click",()=>{this.onSetRegion(o[e]),this.onShowALLRegions(!1)})})}REDIRECT_TO_SUBDOMAIN({currentRegionCode:t,currentRegionId:e}){const i=window.location.hostname,o=window.location.protocol,n=window.location.href.replace(i,t),s=new URL(n,`${o}${t}`);s.searchParams.set("redirectRegionId",e),window.location.href=s.toString()}onInputSearch(t,e){const i=e||this.selectRegion;this.getEntity(i,"regions_vars",!0).forEach(t=>t.remove());const o=t.currentTarget.value,n=this.getEntity(i,"select-city__modal__submit__vars");if(o.length<2)return void n.setAttribute("style","display: none;");const s=t.currentTarget,r=Object.keys(this.loctionList).filter(t=>new RegExp(o,"i").test(this.loctionList[t]));r.length>0?n.setAttribute("style","display: block;"):n.setAttribute("style","display: none;"),r.forEach(t=>{const e=document.createElement("div");e.setAttribute("data-entity","regions_vars"),e.setAttribute("class","regions_vars"),e.setAttribute("tabindex",0),e.innerText=this.loctionList[t],e.addEventListener("click",()=>{s.value=this.loctionList[t],this.getEntity(i,"regions_vars",!0).forEach(t=>t.remove()),n.setAttribute("style","display: none;"),this.getEntity(i,"select-city__modal__submit__btn").removeAttribute("disabled")}),n.append(e)})}removeRegionGetParams(t){if(t.has("redirectRegionId")){const t=new URL(window.location.href,window.location.href);t.searchParams.delete("redirectRegionId"),window.history.replaceState(null,"",t)}}};